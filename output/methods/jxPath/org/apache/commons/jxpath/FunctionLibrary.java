public void addFunctions(Functions functions) { [EOL]     allFunctions.add(functions); [EOL]     byNamespace = null; [EOL] } <line_num>: 41,44
public void removeFunctions(Functions functions) { [EOL]     allFunctions.remove(functions); [EOL]     byNamespace = null; [EOL] } <line_num>: 49,52
public Set getUsedNamespaces() { [EOL]     if (byNamespace == null) { [EOL]         prepareCache(); [EOL]     } [EOL]     return byNamespace.keySet(); [EOL] } <line_num>: 58,63
public Function getFunction(String namespace, String name, Object[] parameters) { [EOL]     if (byNamespace == null) { [EOL]         prepareCache(); [EOL]     } [EOL]     Object candidates = byNamespace.get(namespace); [EOL]     if (candidates instanceof Functions) { [EOL]         return ((Functions) candidates).getFunction(namespace, name, parameters); [EOL]     } else if (candidates instanceof List) { [EOL]         List list = (List) candidates; [EOL]         int count = list.size(); [EOL]         for (int i = 0; i < count; i++) { [EOL]             Function function = ((Functions) list.get(i)).getFunction(namespace, name, parameters); [EOL]             if (function != null) { [EOL]                 return function; [EOL]             } [EOL]         } [EOL]     } [EOL]     return null; [EOL] } <line_num>: 69,99
private void prepareCache() { [EOL]     byNamespace = new HashMap(); [EOL]     int count = allFunctions.size(); [EOL]     for (int i = 0; i < count; i++) { [EOL]         Functions funcs = (Functions) allFunctions.get(i); [EOL]         Set namespaces = funcs.getUsedNamespaces(); [EOL]         for (Iterator it = namespaces.iterator(); it.hasNext(); ) { [EOL]             String ns = (String) it.next(); [EOL]             Object candidates = byNamespace.get(ns); [EOL]             if (candidates == null) { [EOL]                 byNamespace.put(ns, funcs); [EOL]             } else if (candidates instanceof Functions) { [EOL]                 List lst = new ArrayList(); [EOL]                 lst.add(candidates); [EOL]                 lst.add(funcs); [EOL]                 byNamespace.put(ns, lst); [EOL]             } else { [EOL]                 ((List) candidates).add(funcs); [EOL]             } [EOL]         } [EOL]     } [EOL] } <line_num>: 101,124
