public StatisticalReferenceDataset(final BufferedReader in) throws IOException { [EOL]     final ArrayList<String> lines = new ArrayList<String>(); [EOL]     for (String line = in.readLine(); line != null; line = in.readLine()) { [EOL]         lines.add(line); [EOL]     } [EOL]     int[] index = findLineNumbers("Data", lines); [EOL]     if (index == null) { [EOL]         throw new AssertionError("could not find line indices for data"); [EOL]     } [EOL]     this.numObservations = index[1] - index[0] + 1; [EOL]     this.x = new double[this.numObservations]; [EOL]     this.y = new double[this.numObservations]; [EOL]     for (int i = 0; i < this.numObservations; i++) { [EOL]         final String line = lines.get(index[0] + i - 1); [EOL]         final String[] tokens = line.trim().split(" ++"); [EOL]         this.y[i] = Double.parseDouble(tokens[0]); [EOL]         this.x[i] = Double.parseDouble(tokens[1]); [EOL]     } [EOL]     index = findLineNumbers("Starting Values", lines); [EOL]     if (index == null) { [EOL]         throw new AssertionError("could not find line indices for starting values"); [EOL]     } [EOL]     this.numParameters = index[1] - index[0] + 1; [EOL]     double[][] start = null; [EOL]     this.a = new double[numParameters]; [EOL]     this.sigA = new double[numParameters]; [EOL]     for (int i = 0; i < numParameters; i++) { [EOL]         final String line = lines.get(index[0] + i - 1); [EOL]         final String[] tokens = line.trim().split(" ++"); [EOL]         if (start == null) { [EOL]             start = new double[tokens.length - 4][numParameters]; [EOL]         } [EOL]         for (int j = 2; j < tokens.length - 2; j++) { [EOL]             start[j - 2][i] = Double.parseDouble(tokens[j]); [EOL]         } [EOL]         this.a[i] = Double.parseDouble(tokens[tokens.length - 2]); [EOL]         this.sigA[i] = Double.parseDouble(tokens[tokens.length - 1]); [EOL]     } [EOL]     if (start == null) { [EOL]         throw new IOException("could not find starting values"); [EOL]     } [EOL]     this.numStartingPoints = start.length; [EOL]     this.startingValues = start; [EOL]     double dummyDouble = Double.NaN; [EOL]     String dummyString = null; [EOL]     for (String line : lines) { [EOL]         if (line.contains("Dataset Name:")) { [EOL]             dummyString = line.substring(line.indexOf("Dataset Name:") + 13, line.indexOf("(")).trim(); [EOL]         } [EOL]         if (line.contains("Residual Sum of Squares")) { [EOL]             final String[] tokens = line.split(" ++"); [EOL]             dummyDouble = Double.parseDouble(tokens[4].trim()); [EOL]         } [EOL]     } [EOL]     if (Double.isNaN(dummyDouble)) { [EOL]         throw new IOException("could not find certified value of residual sum of squares"); [EOL]     } [EOL]     this.residualSumOfSquares = dummyDouble; [EOL]     if (dummyString == null) { [EOL]         throw new IOException("could not find dataset name"); [EOL]     } [EOL]     this.name = dummyString; [EOL]     this.problem = new MultivariateDifferentiableVectorFunction() { [EOL]  [EOL]         public double[] value(final double[] a) { [EOL]             DerivativeStructure[] dsA = new DerivativeStructure[a.length]; [EOL]             for (int i = 0; i < a.length; ++i) { [EOL]                 dsA[i] = new DerivativeStructure(a.length, 0, a[i]); [EOL]             } [EOL]             final int n = getNumObservations(); [EOL]             final double[] yhat = new double[n]; [EOL]             for (int i = 0; i < n; i++) { [EOL]                 yhat[i] = getModelValue(getX(i), dsA).getValue(); [EOL]             } [EOL]             return yhat; [EOL]         } [EOL]  [EOL]         public DerivativeStructure[] value(final DerivativeStructure[] a) { [EOL]             final int n = getNumObservations(); [EOL]             final DerivativeStructure[] yhat = new DerivativeStructure[n]; [EOL]             for (int i = 0; i < n; i++) { [EOL]                 yhat[i] = getModelValue(getX(i), a); [EOL]             } [EOL]             return yhat; [EOL]         } [EOL]     }; [EOL] } <line_num>: 79,178
public double[] value(final double[] a) { [EOL]     DerivativeStructure[] dsA = new DerivativeStructure[a.length]; [EOL]     for (int i = 0; i < a.length; ++i) { [EOL]         dsA[i] = new DerivativeStructure(a.length, 0, a[i]); [EOL]     } [EOL]     final int n = getNumObservations(); [EOL]     final double[] yhat = new double[n]; [EOL]     for (int i = 0; i < n; i++) { [EOL]         yhat[i] = getModelValue(getX(i), dsA).getValue(); [EOL]     } [EOL]     return yhat; [EOL] } <line_num>: 155,166
public DerivativeStructure[] value(final DerivativeStructure[] a) { [EOL]     final int n = getNumObservations(); [EOL]     final DerivativeStructure[] yhat = new DerivativeStructure[n]; [EOL]     for (int i = 0; i < n; i++) { [EOL]         yhat[i] = getModelValue(getX(i), a); [EOL]     } [EOL]     return yhat; [EOL] } <line_num>: 168,175
public String getName() { [EOL]     return name; [EOL] } <line_num>: 185,187
public int getNumObservations() { [EOL]     return numObservations; [EOL] } <line_num>: 194,196
public double[][] getData() { [EOL]     return new double[][] { MathArrays.copyOf(x), MathArrays.copyOf(y) }; [EOL] } <line_num>: 204,208
public double getX(final int i) { [EOL]     return x[i]; [EOL] } <line_num>: 216,218
public double getY(final int i) { [EOL]     return y[i]; [EOL] } <line_num>: 226,228
public int getNumParameters() { [EOL]     return numParameters; [EOL] } <line_num>: 235,237
public double[] getParameters() { [EOL]     return MathArrays.copyOf(a); [EOL] } <line_num>: 244,246
public double getParameter(final int i) { [EOL]     return a[i]; [EOL] } <line_num>: 254,256
public double[] getParametersStandardDeviations() { [EOL]     return MathArrays.copyOf(sigA); [EOL] } <line_num>: 263,265
public double getParameterStandardDeviation(final int i) { [EOL]     return sigA[i]; [EOL] } <line_num>: 274,276
public double getResidualSumOfSquares() { [EOL]     return residualSumOfSquares; [EOL] } <line_num>: 283,285
public int getNumStartingPoints() { [EOL]     return numStartingPoints; [EOL] } <line_num>: 293,295
public double[] getStartingPoint(final int i) { [EOL]     return MathArrays.copyOf(startingValues[i]); [EOL] } <line_num>: 303,305
public MultivariateDifferentiableVectorFunction getLeastSquaresProblem() { [EOL]     return problem; [EOL] } <line_num>: 313,315
public abstract DerivativeStructure getModelValue(final double x, final DerivativeStructure[] a); <line_num>: 325,325
private static int[] findLineNumbers(final String key, final Iterable<String> lines) { [EOL]     for (String text : lines) { [EOL]         boolean flag = text.contains(key) && text.contains("lines") && text.contains("to") && text.contains(")"); [EOL]         if (flag) { [EOL]             final int[] numbers = new int[2]; [EOL]             final String from = text.substring(text.indexOf("lines") + 5, text.indexOf("to")); [EOL]             numbers[0] = Integer.parseInt(from.trim()); [EOL]             final String to = text.substring(text.indexOf("to") + 2, text.indexOf(")")); [EOL]             numbers[1] = Integer.parseInt(to.trim()); [EOL]             return numbers; [EOL]         } [EOL]     } [EOL]     return null; [EOL] } <line_num>: 348,365
