public DisplayChart() { [EOL]     super(); [EOL] } <line_num>: 76,78
public void init() throws ServletException { [EOL]     return; [EOL] } <line_num>: 85,87
public void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { [EOL]     HttpSession session = request.getSession(); [EOL]     String filename = request.getParameter("filename"); [EOL]     if (filename == null) { [EOL]         throw new ServletException("Parameter 'filename' must be supplied"); [EOL]     } [EOL]     filename = ServletUtilities.searchReplace(filename, "..", ""); [EOL]     File file = new File(System.getProperty("java.io.tmpdir"), filename); [EOL]     if (!file.exists()) { [EOL]         throw new ServletException("File '" + file.getAbsolutePath() + "' does not exist"); [EOL]     } [EOL]     boolean isChartInUserList = false; [EOL]     ChartDeleter chartDeleter = (ChartDeleter) session.getAttribute("JFreeChart_Deleter"); [EOL]     if (chartDeleter != null) { [EOL]         isChartInUserList = chartDeleter.isChartAvailable(filename); [EOL]     } [EOL]     boolean isChartPublic = false; [EOL]     if (filename.length() >= 6) { [EOL]         if (filename.substring(0, 6).equals("public")) { [EOL]             isChartPublic = true; [EOL]         } [EOL]     } [EOL]     boolean isOneTimeChart = false; [EOL]     if (filename.startsWith(ServletUtilities.getTempOneTimeFilePrefix())) { [EOL]         isOneTimeChart = true; [EOL]     } [EOL]     if (isChartInUserList || isChartPublic || isOneTimeChart) { [EOL]         ServletUtilities.sendTempFile(file, response); [EOL]         if (isOneTimeChart) { [EOL]             file.delete(); [EOL]         } [EOL]     } else { [EOL]         throw new ServletException("Chart image not found"); [EOL]     } [EOL]     return; [EOL] } <line_num>: 98,152
